<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">
    <title>Document</title>
    <style>
        .btn-close{
          color: white;
        }
    </style>
</head>
<body>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe" crossorigin="anonymous"></script>

<div class="buttoni" style="cursor: pointer;" data-bs-toggle="modal" data-bs-target="#exampleModal" data-bs-whatever="@mdo" onclick="">
    <div class="contenti">Join the Community</div>
</div>

<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true" style="background: #3A6262; /* fallback color */
background: radial-gradient(ellipse at center, #3A6262 0%, rgba(17, 18, 18, 1) 100%);
background-size: 100%;">
  <div class="modal-dialog">
    <div class="modal-content" style="background: none;">
      <div class="modal-header" style="justify-content: center; color: white;">
        <h1 class="modal-title fs-5" id="exampleModalLabel">Join the community for the latest updates!</h1>
       
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-header" style="justify-content: center; color: white;">
       
        <h3 class="modal-title fs-5" id="exampleModalLabel">Stay up to date with the news and update release</h3>
        
      </div>
      <form name="submit-to-google-sheet">
      <div class="modal-body">
       
          <div class="mb-3">
            
            <input type="text" class="form-control bg-info" id="message-text" name="name" placeholder="Enter Your Name">
          </div>
          <div class="mb-3">
            <input type="email" class="form-control bg-info" id="recipient-name" name="email"  placeholder="Enter Your Email">
           
          </div>
       
      </div>
      <div class="modal-footer" style="justify-content: center;">
        
        <button type="submit" class="btn btn-dark"  onclick="event.preventDefault(); return verify()">Join the Community</button>
        <!--  -->
      </div>
    </form>
    </div>
  </div>
</div>
<div class="modal fade" id="exampleModalToggle2" aria-hidden="true" aria-labelledby="exampleModalToggleLabel2" tabindex="-1" style="background: #3A6262; /* fallback color */
background: radial-gradient(ellipse at center, #3A6262 0%, rgba(17, 18, 18, 1) 100%);
background-size: 100%;">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content" style="background:none;">
       
        <div class="modal-body" style="justify-content: center; color: white;  display: flex;" >
            Thanks for registering with us !
        </div>
        
      </div>
    </div>
  </div>
  <div class="modal fade" id="exampleModalToggle1" aria-hidden="true" aria-labelledby="exampleModalToggleLabel2" tabindex="-1" style="background: #3A6262; /* fallback color */
  background: radial-gradient(ellipse at center, #3A6262 0%, rgba(17, 18, 18, 1) 100%);
  background-size: 100%;">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content" style="background:none;">
       
        <div class="modal-body" style="justify-content: center; color: white;  display: flex;" >
            Email Already Exists
        </div>
        
      </div>
    </div>
  </div>
<script>
//   function check(){
//     const scriptURL = 'https://script.google.com/macros/s/AKfycbzFg4zKE2M6NIrluxnHfloS8vQpyvzGcTD6zJFq9swa9sD2V-6Pf4J-TZMrH9DdT8Ll/exec';
//     const form = document.forms['submit-to-google-sheet'];
    
//     form.addEventListener('submit', (e) => {
//   e.preventDefault();
//   fetch(scriptURL, { method: 'POST', body: new FormData(form)})
//     .then(response => {
//         console.log(response);
      
//       if (response.ok) {
//         return response.json();
//       } else {
//         throw new Error('Network response was not ok.');
//       }
//     })
//     .then(data => {
//       console.log(data);
     
      
//     })
//     .catch(error => console.error('Error!', error.message));
// });

//   }
    
    async function loadData(arr) {
  const url ='https://script.google.com/macros/s/AKfycbxgS9TAopiANg_7jAkC2Slf_xItyvs1SBW4LHgOqSli_bV6NcgevKn0uFVyPNOLlb-L/exec';
  try {
    const response = await fetch(url);
    const data = await response.json();
    data.data.forEach(ele => {
      arr.push(ele);
      
    });
  } catch (error) {
    console.error('Error fetching data:', error);
  }
}

async function verify() {
  if (document.getElementById('recipient-name').value){
  let arr = [];
  loadData(arr)
    .then(() => {
      // console.log(arr);
      var bool = false;
      for (let i = 0; i < arr.length; i++) {
  if (arr[i] === document.getElementById('recipient-name').value) {
    bool = true;
    // console.log("exec");
    break;
  }
}

      console.log(bool);
      var modalToggle = document.querySelector("#exampleModal");
      console.log(bool)
      if (bool===true) {
        $('#exampleModal').modal('hide');
        // to show alerts
        // var alertDiv = document.createElement('div');
        // alertDiv.classList.add('alert', 'alert-warning', 'alert-dismissible', 'fade', 'show');
        // alertDiv.innerHTML = 'Email already exist';
        // var button = document.createElement('button');
        // button.type = 'button';
        // button.classList.add('btn-close');
        // button.setAttribute('data-bs-dismiss', 'alert');
        // button.setAttribute('aria-label', 'Close');
        // alertDiv.appendChild(button);
        // document.body.appendChild(alertDiv);
        $('#exampleModalToggle1').modal('show');
setTimeout(function() {
  $('#exampleModalToggle1').modal('hide');
}, 3000);
        // setTimeout(function() {
        //   alertDiv.remove();
         
        // }, 5000);
      } else if(bool===false) {
        $('#exampleModal').modal('hide');
        // to show alert
        // var alertDiv = document.createElement('div');
        // alertDiv.classList.add('alert', 'alert-success', 'alert-dismissible', 'fade', 'show');
        // alertDiv.innerHTML = '<strong>Thanks</strong> For register!';
        // var button = document.createElement('button');
        // button.type = 'button';
        // button.classList.add('btn-close');
        // button.setAttribute('data-bs-dismiss', 'alert');
        // button.setAttribute('aria-label', 'Close');
        // alertDiv.appendChild(button);
        // document.body.appendChild(alertDiv);
        $('#exampleModalToggle2').modal('show');
setTimeout(function() {
  $('#exampleModalToggle2').modal('hide');
}, 3000);
        // setTimeout(function() {
        //   alertDiv.remove();
         
        // }, 5000);
        
        // Add the fetch function to submit data to the Google Sheet
        const form = document.forms['submit-to-google-sheet'];
        const scriptURL = 'https://script.google.com/macros/s/AKfycbzFg4zKE2M6NIrluxnHfloS8vQpyvzGcTD6zJFq9swa9sD2V-6Pf4J-TZMrH9DdT8Ll/exec';
        fetch(scriptURL, { method: 'POST', body: new FormData(form)})
          .then(response => {
            console.log(response);
            if (response.ok) {
              return response.json();
            } else {
              throw new Error('Network response was not ok.');
            }
          })
          .then(data => {
            console.log(data);
          })
          .catch(error => console.error('Error!', error.message));
      }
    });
    history.replaceState({}, document.title, window.location.pathname);
  }
  else{
    // $('#exampleModal').modal('hide');
    alert("enter the data Before submitting");
    var alertDiv = document.createElement('div');
        alertDiv.classList.add('alert', 'alert-danger', 'alert-dismissible', 'fade', 'show');
        alertDiv.innerHTML = '<strong>Enter Your Data</strong>';
        var button = document.createElement('button');
        button.type = 'button';
        button.classList.add('btn-close');
        button.setAttribute('data-bs-dismiss', 'alert');
        button.setAttribute('aria-label', 'Close');
        alertDiv.appendChild(button);
        alertDiv.style.zIndex='1';
        document.body.appendChild(alertDiv);
        setTimeout(function() {
          alertDiv.remove();
         
        }, 5000);
  }
  
}


</script>
</body>
</html>